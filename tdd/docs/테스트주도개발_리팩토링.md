# 테스트 주도 개발 리팩토링
### 차이점 일치시키기
비슷해 보이는 두 코드 조각을 합치려면 두 코드가 단계적으로 닮아가게끔 수정하면 된다. 
- 두 반복문의 구조가 비슷하다. 이 둘을 동일하게 만들고 나서 하나로 합친다.
- 조건문에 의해 나눠지는 두 분기의 코드가 비슷하다. 이 둘을 동일하게 만들고 나서 조건문을 제거한다.
- 두 클래스가 비슷하다. 이 둘을 동일하게 만들고 나서 하나를 제거한다. 

### 변화 격리하기
객체나 메서드의 일부만 바꾸려면 일단, 바꿔야 할 부분을 격리한다.
- 메서드 추출하기
- 객채 추출하기
- 메서드 객체


### 데이터 이주시키기
표현 양식을 변경하려면 일시적으로 데이터를 중복시키면 된다. 

1. 내부에서 외부로 변화시키기 : 내부의 표현 양식을 변경한 후 외부 인터페이스를 변화시키는 방법
   - 새로운 포맷의 인스턴스 변수를 추가한다.
   - 기존 포맷의 인스턴스 변수를 세팅하는 모든 부분에서 새로운 인스턴스 변수도 세팅하게 만든다.
   - 기존 변수를 사용하는 모든 곳에서 새 변수를 사용하게 만든다. 
   - 기존 포맷을 제거한다.
   - 새 포맷에 맞게 외부 인터페이스를 변경한다.

2. API 변화시키기
   - 새 포맷으로 인자를 하나 추가한다.
   - 새 포맷 인자에서 이전 포맷의 내부적 표현방식으로 번역한다.
   - 이전 포맷 인자를 삭제한다.
   - 이전 포맷을 사용하는 것들을 새 포맷으로 바꾼다.
   - 이전 포맷을 지운다.

### 메서드 추출하기
길고 복잡한 메서드를 읽기 쉽게 만들기 위해서 긴 메서드의 일부분을 별도의 메서드로 분리해내고 이를 호출하게 할 수 있다. 
- 복잡한 코드를 이해하고자 할 때, 메서드로 추출하고 적절한 이름을 붙여준다.
- 중복을 제거하기 위해 메서드 추출을 사용할 수 있다.

### 메서드 인라인
산재한 제어 흐름을 단순화하기 위해 메서드를 호출하는 부분을 호출될 메서드의 본문으로 교체할 수 있다. 
- 산재한 로직을 파악하기 위해 추상화 계층을 인라인시켜 놓고 어떻게 돌아가는지 이해한 다음 필요성에 기반하여 다시 추상화를 수행하자.

### 인터페이스 추출하기
오퍼레이션에 대한 추가 구현을 하려면 공통되는 오퍼레이션을 담고 있는 인터페이스를 만들 수 있다.

### 메서드 옮기기
메서드가 어울리는 자리를 찾으려면 클래스에 메서드를 추가하고 이를 호출하게 할 수 있다.
~~~java
class Shape {
    ...
    int width = bounds.right() - bounds.left();
}
~~~

 - 다음과 같이 한 메서드에서 다른 객체에 하나 이상의 메세지를 보내는 케이스가 생기면 리팩토링을 시도하자.

~~~java
class Rectangle {
    public int area() {
        int width = this.right() - this.left();
        int height = this.bottom() - this.top();
        return width * height;
    }
}

class Shape {
    int area = bounds.area();
}
~~~
- 다른 객체에 대한 두 개 이상의 메시지를 보내는 코드를 볼 때마다 메서드를 옮긴다.
- 리팩토링 절차가 빠르고 안전하다.

### 메서드 객체
여러 개의 매개 변수와 지역 변수를 갖는 복잡한 메서드는 메서드를 꺼내서 객체로 만들 수 있다.
- 메서드 객체는 메서드 추출하기를 적용할 수 없는 코드를 간결하게 만들기 위한 용도로도 적합하다.

### 매개 변수 추가
메서드에 매개 변수를 추가하려면 어떻게 해야할까?
1. 메서드가 인ㅌ퍼ㅔ이스에 선언되어 있다면 일단 인터페이스에 매개 변수를 축하ㅏㄴ다.
2. 매개 변수를 추가한다.
3. 컴파일 에러가 고쳐야 할 부분을 알려준다. 이를 고친다.

### 메서드 매개 변수를 생성자 매개 변수로 바꾸기
하나 이상의 메서드의 매개 변수를 생성자로 옮기려면 어떻게 해야할까?
1. 생성자에게 매개 변수를 추가한다.
2. 매개 변수와 같은 이름을 갖는 인스턴스 변수를 추가한다.
3. 생성자에서 인스턴스 변수의 값을 설정한다.
4. parameter를 this.parameter로 하나씩 찾아 바꾼다.
5. 매개 변수에 대한 참조가 더 이상 존재하지 않으면 해당 매개 변수를 메서드와 모든 호출자에서 제거한다. 
6. 이제 필요 없어진 this를 제거한다. 
7. 변수명을 적절히 변경한다. 
