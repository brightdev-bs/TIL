# 자바 직렬화의 대안을 찾으라
## 자바 직렬화
   자바에 처음으로 직렬화가 도입되었을 때, 프로그래머가 어렵지 않게 분산 객체를 만들 수 있어 매력적이었다. 하지만 보이지 않는 생성자, API와 구현 사이의 모호해진 경계, 
   잠재적인 정확성 문제, 성능, 보안, 유지보수성 등 그 대가가 컸다.
   
### 직렬화의 문제
직렬화의 근본적인 문제는 공격 범위가 너무 넓고 지속적으로 더 넓어져 방어하기 어렵다는 점이다. 
 - ObjectInputStream의 readObject 메서드를 호출하면서 객체 그래프가 역직렬화되기 때문이다.
 - 바이트 스트림을 역직렬화하는 과정에서 이 메서드는 그 타입들 안의 모든 코드를 수행할 수 있다. 

### 역직렬화를 하지 말자
직렬화 위험을 회피하는 가장 좋은 방법은 아무것도 역직렬화하지 않는 것이다. 대신 JSON과 프로토콜 버퍼와 같은 크로스 플랫폼 구조화된 데이터 표현을 사용하자

만약 레거시 시스템 때문에 자바 직렬화를 완전히 배제할 수 없다면 차선책은 다음과 같다.
1. 신뢰할 수 없는 데이터는 절대 역직렬화하지 않는다.
2. 객체 역직렬화 필터링을 사용하자.
   - 직렬화를 피할 수 없고 역직렬화한 데이터가 안전한지 확신할 수 없을 때만 사용하자
3. 시간과 노력을 들여서라도 크로스-플랫폼 구조화된 데이터 표현으로 마이그레이션하는 것을 심각하게 고민해보자. 

## 크로스 플랫폼 구조화된 데이터 표현
   - 임의 객체 그래프를 자동으로 직렬화/역직렬화하지 않는다.
   - 속성-값 쌍의 집합으로 구성된 간단하고 구조화된 데이터 객체를 사용한다. 

### JSON과 Protocol Buffers
 - JSON은 텍스트 기반이라 사람이 읽을 수 있고, 프로토콜 버퍼는 이진 표현이라 효율이 훨씬 높다
 - JSON은 오직 데이터를 표현하는 데만 쓰이지만, 프로토콜 버퍼는 문서를 위한 스키마(타입)를 제공하고 올바로 쓰도록 강요한다.
 - 효율은 프로토콜 버퍼가 훨씬 좋지만, 텍스트 기반 표현에는 JSON이 아주 효과적이다.